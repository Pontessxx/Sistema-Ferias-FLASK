{% extends "base.html" %}
{% block content %}

<h1>Folga Assiduidade</h1>

<form action="/adicionar-folga" method="POST" id="formFolga" class="form-section">

    <input type="hidden" id="folga_id" name="folga_id">

    <div class="form-group">
        <label>Funcionário:</label>
        <select name="funcionario_folga_id" id="funcionario_folga_id" required>
            <option value="">Selecione...</option>
            {% for f in funcionarios %}
                <option value="{{ f[0] }}">{{ f[1] }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="form-group">
        <label>Ano da folga:</label>
        <select name="ano" id="ano" required>
            <option value="{{ ano_atual }}">{{ ano_atual }}</option>
            <option value="{{ ano_proximo }}">{{ ano_proximo }}</option>
        </select>
    </div>

    <div class="form-group">
        <label>Data da folga:</label>
        <input type="date" name="data_folga" id="data_folga" required>
    </div>

    <div class="form-buttons">
        <button type="submit" id="btnFolga" class="btn">Salvar Folga</button>
        <button type="button" id="btnExcluirFolga" class="btn-secondary" onclick="excluirFolga()" style="display:none;">Excluir Folga</button>
    </div>

</form>

<hr>

<h2>Folgas cadastradas</h2>

<table class="table">
    <tr>
        <th>Funcionário</th>
        <th>Ano</th>
        <th>Data</th>
        <th>Ações</th>
    </tr>

    {% for f in folgas %}
    <tr>
        <td>{{ f.nome }}</td>
        <td>{{ f.ano }}</td>
        <td>{{ f.data_folga }}</td>
        <td>
            <a href="/deletar-folga/{{ f.id }}" class="excluir">Excluir</a>
        </td>
    </tr>
    {% endfor %}
</table>

<script>
function excluirFolga() {
    const id = document.getElementById("folga_id").value;
    if (!id) return alert("Nenhuma folga selecionada.");
    window.location.href = `/deletar-folga/${id}`;
}
</script>

{% endblock %}
