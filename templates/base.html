<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">

    <title>{{ title or "Sistema de Escala - f√©rias" }}</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='styles/styles.css') }}">
</head>
<body>

    <!-- TOPO -->
    <div class="topbar">
        <span class="hamburger" onclick="openMenu()">&#9776;</span>

        Sistema de Escala - f√©rias

        <button id="btnTema" onclick="toggleTema()" 
                style="background:none; border:1px solid #fff; padding:6px 10px; border-radius:6px; color:white; cursor:pointer;">
            üåô
        </button>
    </div>

    <!-- MENU LATERAL -->
    <div id="sidebar" class="sidebar">
        <span class="close-btn" onclick="closeMenu()">&times;</span>

        <a href="/"> In√≠cio</a>
        <a href="/funcionarios"> Funcion√°rios</a>
        <a href="/abono-folga"> Abono e Folga</a>
        <a href="/gantt"> Gr√°fico Anual</a>
    </div>

    <!-- CONTE√öDO -->
    <div class="content">
        {% block content %}{% endblock %}
    </div>

    <!-- SCRIPT CENTRAL -->
    <script>

        /* -------------------------
           MENU LATERAL
        ------------------------- */
        function openMenu() {
            document.getElementById("sidebar").style.width = "260px";
        }

        function closeMenu() {
            document.getElementById("sidebar").style.width = "0";
        }

        /* -------------------------
           COOKIES
        ------------------------- */
        function obterCookie(nome) {
            const valor = document.cookie.split("; ").find(l => l.startsWith(nome + "="));
            return valor ? valor.split("=")[1] : null;
        }

        /* -------------------------
           DEFINIR BOT√ÉO DO TEMA
        ------------------------- */
        function atualizarBotao(tema) {
            const btn = document.getElementById("btnTema");
            btn.textContent = tema === "dark" ? "‚òÄÔ∏è" : "üåô";
        }

        /* -------------------------
           TROCAR TEMA
        ------------------------- */
        function toggleTema() {
            const atual = document.documentElement.getAttribute("data-theme") || "light";
            const novoTema = atual === "light" ? "dark" : "light";

            // Aplica tema visualmente
            document.documentElement.setAttribute("data-theme", novoTema);

            // salva cookie (1 ano)
            document.cookie = `theme=${novoTema}; path=/; max-age=31536000`;

            atualizarBotao(novoTema);

            // üî• SE ESTIVER NA P√ÅGINA DO GANTT, RECARREGA PARA ATUALIZAR O GR√ÅFICO
            if (window.location.pathname === "/gantt") {
                window.location.reload();
            }
        }


        /* -------------------------
           APLICAR TEMA AO CARREGAR
        ------------------------- */
        document.addEventListener("DOMContentLoaded", () => {
            const temaCookie = obterCookie("theme");
            const tema = temaCookie || "light";

            document.documentElement.setAttribute("data-theme", tema);
            atualizarBotao(tema);
        });

    </script>

</body>
</html>
