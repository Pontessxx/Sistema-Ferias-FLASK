<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">

    <!-- ============================================================
         T√çTULO DA P√ÅGINA
         - Pode ser substitu√≠do dinamicamente via contexto Jinja
         ============================================================ -->
    <title>{{ title or "Sistema de Escala - f√©rias" }}</title>

    <!-- ============================================================
         IMPORTA√á√ÉO DO CSS GLOBAL
         ============================================================ -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/styles.css') }}">
</head>
<body>

    <!-- ============================================================
         BARRA SUPERIOR (TOPO DO SISTEMA)
         - Cont√©m:
           * bot√£o hamburguer ‚Üí abre menu lateral
           * t√≠tulo do sistema
           * bot√£o para alternar entre tema claro/escuro
         ============================================================ -->
    <div class="topbar">
        <!-- √çcone de menu lateral (abre sidebar) -->
        <span class="hamburger" onclick="openMenu()">&#9776;</span>

        <!-- Nome do sistema -->
        Sistema de Escala - f√©rias

        <!-- Bot√£o de altern√¢ncia de tema -->
        <button id="btnTema" onclick="toggleTema()" 
                style="background:none; border:1px solid #fff; padding:6px 10px; border-radius:6px; color:white; cursor:pointer;">
            üåô <!-- √çcone inicial, alterado via JavaScript -->
        </button>
    </div>

    <!-- ============================================================
         MENU LATERAL (SIDEBAR)
         - Navega√ß√£o geral do sistema
         - Pode ser aberto/fechado via fun√ß√µes openMenu() / closeMenu()
         ============================================================ -->
    <div id="sidebar" class="sidebar">
        <span class="close-btn" onclick="closeMenu()">&times;</span>

        <!-- Links de navega√ß√£o -->
        <a href="/"> In√≠cio</a>
        <a href="/funcionarios"> Funcion√°rios</a>
        <a href="/abono-folga"> Abono e Folga</a>
        <a href="/gantt"> Gr√°fico Anual</a>
    </div>

    <!-- ============================================================
         √ÅREA PRINCIPAL DO CONTE√öDO
         - As p√°ginas espec√≠ficas ir√£o preencher este bloco
         ============================================================ -->
    <div class="content">
        {% block content %}{% endblock %}
    </div>

    <!-- ============================================================
         SCRIPT DO MENU E DO SISTEMA DE TEMA
         ============================================================ -->
    <script>

        /* ------------------------------------------------------------
           ABRIR SIDEBAR (MENU LATERAL)
        ------------------------------------------------------------ */
        function openMenu() {
            document.getElementById("sidebar").style.width = "260px";
        }

        /* ------------------------------------------------------------
           FECHAR SIDEBAR (MENU LATERAL)
        ------------------------------------------------------------ */
        function closeMenu() {
            document.getElementById("sidebar").style.width = "0";
        }

        /* ------------------------------------------------------------
           AO CARREGAR A P√ÅGINA:
           - Recupera tema salvo no localStorage
           - Ajusta interface para o tema escolhido anteriormente
        ------------------------------------------------------------ */
        document.addEventListener("DOMContentLoaded", () => {
            const temaSalvo = localStorage.getItem("tema") || "light";
            document.documentElement.setAttribute("data-theme", temaSalvo);
            atualizarBotao(temaSalvo);
        });

        /* ------------------------------------------------------------
           ALTERAR TEMA (LIGHT <‚Üí> DARK)
           - Atualiza atributo data-theme no HTML
           - Salva escolha no localStorage
           - Atualiza √≠cone do bot√£o
           - Se estiver no Gantt ‚Üí recarrega gr√°fico j√° com novo tema
        ------------------------------------------------------------ */
        function toggleTema() {
            const atual = document.documentElement.getAttribute("data-theme") || "light";
            const novoTema = atual === "light" ? "dark" : "light";

            // Aplica visualmente
            document.documentElement.setAttribute("data-theme", novoTema);

            // Salva para uso futuro
            localStorage.setItem("tema", novoTema);

            atualizarBotao(novoTema);

            // Atualiza√ß√£o especial:
            // O Gantt precisa de recarregamento para redesenhar com novo tema
            if (window.location.pathname === "/gantt") {
                const url = new URL(window.location.href);
                url.searchParams.set("theme", novoTema);
                window.location.href = url.toString();
            }
        }

        /* ------------------------------------------------------------
           Atualiza √≠cone conforme o tema:
           - Tema claro ‚Üí √≠cone de lua üåô
           - Tema escuro ‚Üí √≠cone de sol ‚òÄÔ∏è
        ------------------------------------------------------------ */
        function atualizarBotao(tema) {
            const btn = document.getElementById("btnTema");
            btn.textContent = tema === "dark" ? "‚òÄÔ∏è" : "üåô";
        }
    </script>

    <!-- Plotly opcional (j√° embutido no gr√°fico quando necess√°rio) -->
    <!-- <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> -->

</body>
</html>
